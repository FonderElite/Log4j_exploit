source files/colors.sh
#!/bin/bash
figlet "Setup.sh"
function build_marshalsec(){
echo -n -e "\n${BWhite}[${BGreen}+${BWhite}]Build Marshalsec with maven?(y/n): " 
read choicem
if [[ $choicem == "y" ]]
then
cd marshalsec && mvn clean package -DskipTests 
echo -e "${BWhite}[${BGreen}+${BWhite}Setup complete!"
elif [[ $choicem == "n" ]]
then
echo -e "${BWhite}[${BYellow}!${BWhite}]Note: If you haven't built Marshalsec yet, you wont be able to have your ldap server up and running." 
sleep 1 
echo -e "${BWhite}[${BGreen}+${BWhite}]If you have built Marshalsec, now execute main.py"
sleep 0.5

fi
}

function install_marshalsec(){
echo -e "${BWhite}[${BYellow}!${BWhite}]Checking prerequisites..."
sleep 0.5
if [ ! -f "/usr/bin/mvn" ];then
  sudo apt update && sudo apt install maven
else
echo -e "${BWhite}[${BGreen}+${BWhite}]/usr/bin/mvn exists."
fi
sleep 0.5

if [ ! -d "marshalsec" ];then
echo -e "${BWhite}[${BYellow}!${BWhite}]Installing marshalsec in the current directory"
git clone https://github.com/mbechler/marshalsec marshalsec
elif [ -d "marshalsec" ];then
echo -e "${BWhite}[${BGreen}+${BWhite}]Marshalsec exists."
fi

if [[ -f "/usr/bin/mvn" ]] && [[ -d "marshalsec" ]];then
build_marshalsec
fi
}
if [ $EUID -eq 0 ];then
install_marshalsec
else
echo -e "${BWhite}[${BRed}-${BWhite}]Please run the script as root."
fi
